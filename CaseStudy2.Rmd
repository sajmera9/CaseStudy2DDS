---
title: "CaseStudy2"
author: "Satvik"
date: "3/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
employee.data = read.csv("Data/CaseStudy2-data.csv", header = TRUE)
employee.data
#check for missing values
library(naniar)
gg_miss_var(employee.data)
#no missing values in employee.data
sapply(employee.data, function(x) sum(is.na(x)))
```

```{r}
#
summary(employee.data)
no.attrition = employee.data %>% filter(Attrition == "No")
str(no.attrition)
yes.attrition = employee.data %>% filter(Attrition == "Yes")
str(yes.attrition)

```

```{r}
yes.attrition %>% ggplot(aes(x = Age)) + geom_histogram()
no.attrition %>% ggplot(aes(x = Age)) + geom_histogram()
```


```{r}
yes.attrition %>% ggplot(aes(x = Department)) + geom_bar()
no.attrition %>% ggplot(aes(x = Department)) + geom_bar()
```

```{r}
no.attrition %>% ggplot(aes(x = Department)) + geom_bar(fill=no.attrition$Department)
no.attrition %>% ggplot(mapping = aes(x = Department, y = ..prop.., group = 1)) + geom_bar(fill = Department)
yes.attrition %>% ggplot(mapping = aes(x = Department, y = ..prop.., group = 1)) + geom_bar()
```



```{r}
employee.data[employee.data$Attrition == "Yes",] %>% ggplot(aes(x=Department)) + geom_bar()
```

```{r}

```


```{r}
#convert job satisfaction to a factor and get bar plot, use percent 

employee.data %>% ggplot(aes(x = as.factor(employee.data$JobSatisfaction))) + geom_bar()


yes.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction), fill = as.factor(JobSatisfaction), y=..prop.., group = 1)) + geom_bar() + ggtitle("Attrition")

yes.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction), fill = factor(..x..), y=..prop.., group = 1)) + geom_bar() + ggtitle("Yes Attrition") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5) + scale_y_continuous(labels = scales::percent) + labs(y = "Percent", fill="Satisfaction Level", x = "Job Satisfaction")

no.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction), fill = factor(..x..), y=..prop.., group = 1)) + geom_bar() + ggtitle("No Attrition") + geom_text(aes( label = scales::percent(..prop..),y= ..prop.. ), stat= "count", vjust = -.5) + scale_y_continuous(labels = scales::percent) + labs(y = "Percent", fill="Satisfaction Level", x = "Job Satisfaction")



no.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction))) + geom_bar() + ggtitle("No Attrition")


fill = factor(..x..)


yes.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction), fill = as.factor(JobSatisfaction))) + geom_bar() + ggtitle("Attrition")

no.attrition %>% ggplot(aes(x = as.factor(JobSatisfaction), fill = as.factor(JobSatisfaction))) + geom_bar() + ggtitle("No Attrition")


```

```{r}
ggplot(data = employee.data, aes(x=DailyRate)) +
geom_histogram(aes(fill=JobSatisfaction)) +
facet_wrap( ~ JobSatisfaction, ncol=2) +
theme_bw()


ggplot(data = employee.data, aes(x=HourlyRate)) +
geom_histogram(aes(fill=JobSatisfaction)) +
facet_wrap( ~ JobSatisfaction, ncol=2) +
theme_bw()

ggplot(data = employee.data, aes(x=MonthlyRate)) +
geom_histogram(aes(fill=JobSatisfaction)) +
facet_wrap( ~ JobSatisfaction, ncol=2) +
theme_bw()

ggplot(data = employee.data, aes(x=MonthlyIncome)) +
geom_histogram(aes(fill=JobSatisfaction)) +
facet_wrap( ~ JobSatisfaction, ncol=2) +
theme_bw()

ggplot(data = employee.data, aes(sample=MonthlyIncome)) +
stat_qq() +
facet_wrap( ~ JobSatisfaction, ncol=1) +
theme_bw()
```


```{r}
employee.data$JobSatisfaction = as.factor(employee.data$JobSatisfaction)
fit = aov(HourlyRate ~ JobSatisfaction, data = employee.data)
summary(fit)



ne = employee.data %>% select(JobSatisfaction,DailyRate)

ne %>% group_by(JobSatisfaction, DailyRate) %>% summarize(new_count = n())
employee.data %>% group_by(JobSatisfaction) %>% summarize(new_count = n())


employee.data %>%
  group_by(JobSatisfaction) %>%
  summarize(var=var(HourlyRate))


##***## 
##**## Job Satisfaction - HourlyRate
employee.data %>% group_by(JobSatisfaction) %>%
  summarise(
    count = n(),
    mean = mean(HourlyRate, na.rm = TRUE),
    sd = sd(HourlyRate, na.rm = TRUE),
    median = median(HourlyRate, na.rm = TRUE),
    IQR = IQR(HourlyRate, na.rm = TRUE)
  )
##***##

library(onewaytests)
fit = aov(HourlyRate~JobSatisfaction, data = employee.data)
summary(fit)

library(lsmeans)

#Contrast 1
fit4 = lm(HourlyRate ~ JobSatisfaction, data = employee.data)
summary(fit4)
fit4

leastsquare = lsmeans(fit4,"JobSatisfaction")

Contrasts = list(OneTwoVersusThreeFour= c(0.5,0.5,-0.5,-0.5))

contrast(leastsquare,Contrasts)

#Contrast 2
fit4 = lm(HourlyRate ~ JobSatisfaction, data = employee.data)
summary(fit4)
fit4

leastsquare = lsmeans(fit4,"JobSatisfaction")

Contrasts = list(OneTwoVersusThreeFour= c(1,0,-0.5,-0.5))
#Contrasts = list(OneTwoVersusThreeFour= c(1,0,0,-1))
#Contrasts = list(OneTwoVersusThreeFour= c(1,0,0,-1))
contrast(leastsquare,Contrasts)




bf.test(HourlyRate ~ JobSatisfaction, data = employee.data)
welch.test(HourlyRate ~ JobSatisfaction, data = employee.data)


#Job Satisfaction - DailyRate
employee.data %>% group_by(JobSatisfaction) %>%
  summarise(
    count = n(),
    mean = mean(DailyRate, na.rm = TRUE),
    sd = sd(DailyRate, na.rm = TRUE),
    median = median(DailyRate, na.rm = TRUE),
    IQR = IQR(DailyRate, na.rm = TRUE)
  )


fit1 = aov(DailyRate~JobSatisfaction, data = employee.data)
summary(fit1)

#Job Satisfaction - MonthlyRate
employee.data %>% group_by(JobSatisfaction) %>%
  summarise(
    count = n(),
    mean = mean(MonthlyRate, na.rm = TRUE),
    sd = sd(MonthlyRate, na.rm = TRUE),
    median = median(MonthlyRate, na.rm = TRUE),
    IQR = IQR(MonthlyRate, na.rm = TRUE)
  )


fit2 = aov(MonthlyRate~JobSatisfaction, data = employee.data)
summary(fit2)

#Job Satisfaction - MonthlyIncome
employee.data %>% group_by(JobSatisfaction) %>%
  summarise(
    count = n(),
    mean = mean(MonthlyIncome, na.rm = TRUE),
    sd = sd(MonthlyIncome, na.rm = TRUE),
    median = median(MonthlyIncome, na.rm = TRUE),
    IQR = IQR(MonthlyIncome, na.rm = TRUE)
  )


bf.test(MonthlyIncome ~ JobSatisfaction, data = employee.data)
fit3 = aov(MonthlyIncome~JobSatisfaction, data = employee.data)
summary(fit3)
kruskal.test(MonthlyIncome ~ JobSatisfaction, data=employee.data)




bf.test(DailyRate ~ JobSatisfaction, data = employee.data)
welch.test(DailyRate ~ JobSatisfaction, data = employee.data)

bf.test(MonthlyIncome ~ JobSatisfaction, data = employee.data)
aov(MonthlyIncome ~ JobSatisfaction, data = employee.data)
welch.test(MonthlyIncome ~ JobSatisfaction, data = employee.data)

group_by(employee.data$JobSatisfaction) %>% summarize(meanAge = count(DailyRate))

```


```{r}


oneway.test(Income2005 ~ Educ, data=edu, var.equal=F)


kruskal.test(DailyRate ~ JobSatisfaction, data=employee.data)
kruskal.test(HourlyRate ~ JobSatisfaction, data=employee.data)
kruskal.test(MonthlyRate ~ JobSatisfaction, data=employee.data)
kruskal.test(MonthlyIncome ~ JobSatisfaction, data=employee.data)



```


```{r}

```



